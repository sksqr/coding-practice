package com.practice.dp;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class LongestIncreasingSubsequence {




  private static int countLengthOfLIS(int[] a, int i, int lastElement){
    if(i >= a.length){
      return 0;
    }
    if(a[i] > lastElement){
      return Math.max(1+ countLengthOfLIS(a,i+1,a[i]), countLengthOfLIS(a,i+1,lastElement) );
    }
    else {
      return countLengthOfLIS(a,i+1,lastElement);
    }
  }

  public static void main(String[] args) {

    List<Integer> list = Arrays.asList(14, 683, 535, 940, 224, 963, 131, 1224, 441, 112, 219, 549, 1858, 1705, 204, 1458, 1239, 312, 1384, 1231, 351, 827, 180, 345, 380, 401, 1766, 1299, 59, 290, 1699, 1688, 741, 1591, 485, 1037, 1568, 576, 1693, 1854, 907, 387, 1069, 899, 260, 1690, 59, 1126, 614, 1343, 12, 945, 329, 757, 1656, 850, 1812, 679, 1697, 802, 1398, 1331, 1217, 297, 1342, 1442, 474, 716, 1184, 674, 504, 737, 1608, 551, 737, 1124, 1410, 426, 1492, 1266, 1906, 191, 1685, 1986, 794, 674, 92, 1138, 1104, 899, 1665, 1305, 1984, 875, 533, 115, 1144, 1317, 1267, 1490, 77, 1411, 784, 354, 732, 24, 1609, 720, 393, 739, 1904, 923, 375, 1049, 427, 617, 454, 994, 1874, 921, 897, 598, 839, 981, 331, 1483, 1990, 1621, 1736, 1725, 474, 1513, 582, 1003, 595, 1710, 1186, 1158, 997, 166, 1851, 1557, 1880, 1677, 1031, 847, 444, 1389, 550, 898, 1872, 1121, 1121, 960, 1765, 1649, 1407, 71, 635, 1306, 94, 526, 1075, 1556, 806, 1010, 1659, 307, 76, 610, 597, 375, 273, 1838, 1052, 239, 1630, 591, 849, 157, 1282, 71, 388, 1044, 1604, 1506, 129, 719, 306, 300, 664, 1765, 666, 1919, 1755, 909, 475, 129, 8, 85, 1206, 666, 544, 297, 1401, 308, 1142, 1896, 1059, 360, 1255, 260, 759, 717, 65, 1981, 552, 1409, 437, 1796, 1665, 908, 953, 927, 1390, 42, 1774, 1420, 545, 802, 1507, 1723, 409, 1199, 452, 1625, 1622, 81, 1356, 63, 172, 391, 1086, 1802, 283, 768, 977, 1323, 500, 1939, 1606, 84, 1473, 1917, 1055, 117, 1535, 1239, 209, 1718, 1040, 720, 1455, 1918, 509, 682, 736, 1268, 1207, 811, 849, 1429, 1653, 358, 1904, 77, 101, 394, 31, 1297, 304, 677, 238, 1370, 530, 393, 1243, 905, 358, 1583, 1476, 1364, 1348, 1893, 1274, 1954, 1888, 818, 813, 865, 46, 390, 1816, 154, 1485, 207, 1777, 1561, 1738, 241, 1741, 71, 1204, 911, 1494, 198, 2, 421, 1115, 1909, 1173, 1996, 1720, 383, 917, 1037, 128, 1447, 1263, 152, 1052, 920, 513, 1129, 1367, 417, 1767, 871, 456, 279, 610, 1428, 1141, 791, 1041, 341, 1923, 936, 837, 1539, 570, 1878, 1543, 1718, 1697, 519, 1053, 1846, 1463, 306, 1204, 881, 123, 249, 8, 1037, 1857, 804, 1122, 1463, 1427, 1237, 1786, 1328, 822, 1149, 1194, 186, 1353, 271, 1984, 1525, 40, 1577, 1806, 290, 1941, 1804, 97, 1442, 863, 1556, 998, 1920, 405, 1243, 1490, 311, 1410, 1913, 651, 717, 945, 328, 827, 1637, 727, 366, 515, 13, 149, 659, 1446, 140, 1465, 338, 1225, 1996, 1752, 232, 1496, 1953, 837, 1979, 97, 1387, 731, 1023, 1590, 441, 1690, 1744, 670, 1882, 1779, 1435, 139, 1091, 1134, 1561, 1178, 1008, 733, 65, 535, 1527, 637, 1676, 218, 1167, 283, 144, 1488, 840, 1315, 1525, 1801, 213, 882, 550, 149, 88, 1486, 1447, 1660, 377, 1429, 691, 1260, 265, 1583, 212, 696, 197, 1484, 1950, 1754, 971, 1172, 1123, 1287, 1605, 1023, 1063, 1663, 1377, 366, 119, 1243, 292, 1641, 1235, 24, 219, 77, 1186, 912, 1609, 1639, 690, 198, 1862, 1910, 644, 16, 1507, 1140, 1411, 279, 1067, 1982, 643, 1498, 992, 1817, 1119, 1472, 79, 838, 1435, 715, 277, 443, 395, 1223, 1539, 1203, 344, 1194, 1603, 468, 623, 368, 318, 1925, 204, 834, 850, 1189, 483, 1122, 18, 525, 1723, 497, 1769, 254, 669, 110, 1423, 985, 261, 1140, 477, 749, 1928, 1001, 847, 1646, 286, 11, 1196, 1525, 36, 686, 1401, 1885, 469, 1570, 866, 290, 1502, 1990, 934, 727, 1933, 758, 1804, 334, 1763, 700, 1963, 941, 35, 92, 1186, 344, 1240, 446, 192, 288, 747, 220, 602, 503, 944, 699, 23, 1515, 1359, 1369, 1776, 1786, 473, 1413, 1166, 1498, 1750, 1860, 179, 199, 1895, 570, 1304, 1162, 1565, 671, 1242, 1055, 1313, 631, 1457, 1703, 1106, 773, 1506, 929, 1227, 1615, 1777, 1707, 598, 1640, 131, 800, 1599, 766, 759, 1161, 94, 1374, 767, 690, 1448, 337, 136, 432, 1017, 1639, 734, 1617, 1535, 1037, 1017, 1097, 514, 751, 1152, 1535, 724, 889, 1991, 1930, 171, 240, 942, 1146, 640, 1520, 1631, 278, 1183, 311, 559, 1518, 1187, 533, 1239, 944, 727, 983, 342, 849, 123, 1427, 1573, 171, 829, 1591, 720, 79, 1343, 1241, 1615, 1629, 1277, 40, 1622, 1349, 211, 281, 1122, 435, 1921, 1087, 261, 1800, 930, 1980, 435, 294, 311, 1187, 677, 1629, 1637, 590, 995, 827, 119, 675, 1380, 311, 1262, 1504, 78, 1981, 1437, 564, 1868, 150, 1801, 658, 1204, 1076, 1192, 59, 882, 1212, 1896, 785, 907, 964, 1123, 383, 889, 1847, 1811, 1049, 1207, 1771, 143, 414, 1831, 1837, 392, 425, 1811, 819, 828, 1355, 387, 842, 762, 676, 1450, 1646, 1706, 193, 1786, 700, 387, 126, 827, 1267, 1776, 244, 224, 1513, 1550, 1582, 464, 1606, 539, 146, 1854, 18, 1311, 1870, 852, 1097, 140, 310, 1470, 587, 1107, 1491, 349, 514, 156, 1435, 853, 1422, 1879, 1278, 1172, 417, 1130, 151, 1775, 550, 1398, 1296, 1364, 1142, 897, 522, 414, 110, 334, 14, 901, 119, 1552, 950, 931, 434, 1715, 249, 1741, 858, 968, 301, 59, 368, 421, 1035, 1202, 1569, 500, 560, 139, 1526, 453, 566, 1331, 122, 250, 157, 1237, 1716, 1767, 1923, 1402, 882, 1666, 1745, 509, 989, 1969, 1911, 1696, 1893, 1831, 208, 1068, 1323, 1825, 489, 1532, 132, 580, 721, 421, 1927, 1361, 248, 725, 1435, 310, 834, 1685, 1800, 728, 462, 982, 92, 473, 506, 837, 1599, 923, 428, 1634, 1022, 665, 203, 768, 435, 1724, 608, 688, 1, 1836, 777, 1490, 601, 1236, 970, 544, 1821, 187, 249, 39, 523, 1659, 1263, 430, 1503, 992, 1858, 134, 284, 1787, 1917, 1118, 705, 503, 1136, 1064, 955, 1990, 227, 1616, 455, 970, 771, 1923, 526, 456, 1618, 1435, 1771, 1788, 1641, 127, 1221, 94, 1806, 1933, 1872, 1989, 1680, 28, 867, 592, 1252, 1233, 1056, 1883, 1452, 200, 408, 1822, 525, 381, 1964, 391, 1746, 697, 750, 261, 1763, 773, 1767, 533, 910, 600, 23, 61, 191, 1357, 391, 627, 193, 834, 131, 1301, 1085, 1522, 1455, 1480, 523, 1843, 669, 730, 1547, 892, 209, 690, 258, 860, 1422, 1373, 1991, 1629, 38, 298, 1495, 1070, 1670, 1941, 1008, 1350, 1861, 1046, 1957, 1114, 1768, 1500, 1001, 1711, 640, 1873, 1888, 278, 409, 747, 1575, 1455, 1266, 860, 221, 1318, 379, 185, 757, 1520, 1655, 1479, 1429, 1172, 959, 1774, 1134, 497, 863, 2001, 1239, 1164, 8, 429, 1584, 69, 780, 1485, 656, 789, 672, 1284, 1598, 880, 954, 140, 1699, 1224, 1389, 1730, 1393, 488, 1990, 1894, 1878, 146, 164, 202, 1867, 1461, 1549, 1702, 1985, 1200, 1449, 1904, 1414, 284, 20, 1585, 1626, 143, 1144, 1639, 1047, 808, 1476, 807, 974, 279, 1547, 230, 1101, 1642, 1097, 322, 1279, 524, 294, 31, 244, 1578, 1716, 1672, 522, 1541, 975, 717, 1623, 288, 23, 356, 844, 1756, 1683, 245, 1416, 1348, 1357, 80, 1729, 1490, 1644, 578, 332, 1005, 867, 1575, 404, 1339, 228, 1225, 1160, 1656, 653, 100, 45, 873, 1621, 342, 1611, 656, 873, 1464, 409, 1814, 749, 298, 1039, 265, 1346, 1654, 239, 1033, 682, 167, 1525, 396, 1718, 503, 1916, 1204, 1147, 1116, 1736, 1086, 482, 908, 1663, 841, 847, 267, 625, 1315, 158, 1078, 534, 88, 787, 1928, 368, 867, 443, 336, 775, 331, 926, 265, 621, 1059, 130, 1558, 80, 1145, 180, 1772, 1767, 1830, 1694, 1992, 881, 1514, 229, 63, 1115, 1095, 627, 480, 1051, 492, 1914, 1513, 1051, 1895, 1719, 1516, 1128, 883, 573, 226, 1818, 1890, 1893, 1526, 1141, 1172, 202, 824, 57, 1029, 1914, 1949, 1550, 717, 1209, 1822, 1240, 274, 1946, 888, 1516, 878, 1061, 525, 888, 235, 1965, 371, 1220, 908, 919, 1354, 35, 1404, 1454, 784, 452, 798, 483, 444, 1158, 1347, 620, 161, 1398, 1632, 755, 1866, 196, 1897, 697, 1450, 1831, 1535, 1542, 1998, 652, 1751, 1176, 650, 78, 623, 1399, 597, 385, 776, 862, 1287, 1522, 193, 449, 974, 853, 990, 149, 186, 413, 265, 740, 1135, 1508, 1804, 76, 881, 1549, 1575, 1824, 958, 249, 408, 783, 610, 80, 606, 1832, 440, 1505, 1116, 94, 1767, 1423, 1904, 550, 233, 41, 686, 1275, 1940, 1457, 31, 786, 1229, 744, 1824, 1219, 1523, 249, 1228, 1365, 1992, 1047, 125, 133, 725, 1032, 1004, 1043, 1034, 634, 1044, 1656, 1991, 801, 1377, 1292, 1459, 1041, 302, 861, 465, 1088, 432, 635, 1260, 490, 992, 285, 379, 809, 969, 51, 1880, 712, 1700, 1552, 1981, 1953, 822, 1751, 1886, 140, 731, 821, 433, 1524, 1423, 1134, 888, 832, 841, 682, 600, 1228, 368, 621, 105, 1038, 80, 311, 1987, 1398, 986, 802, 1303, 869, 657, 416, 1032, 1931, 563, 1869, 1614, 1320, 1035, 1634, 1259, 1282, 377, 1386, 959, 405, 1510, 283, 905, 1178, 1671, 1721, 987, 1775, 461, 980, 1839, 929, 503, 505, 1002, 1845, 498, 1014, 394, 1922, 355, 1265, 433, 1315, 91, 1169, 293, 976, 1516, 793, 952, 950, 231, 1609, 1794, 1618, 58, 672, 1792, 714, 439, 1646, 609, 1317, 1915, 1849, 171, 430, 67, 845, 141, 228, 266, 166, 1832, 937, 951, 448, 635, 1315, 1748, 767, 1360, 1903, 1639, 882, 1352, 1718, 640, 1142, 793, 1770, 1615, 315, 660, 1224, 1146, 445, 1689, 808, 885, 1091, 1497, 1263, 805, 1981, 511, 287, 797, 1586, 1472, 813, 812, 318, 45, 1816, 742, 107, 1323, 1728, 841, 882, 1139, 1205, 66, 1965, 1955, 76, 148, 1473, 905, 899, 1972, 294, 416, 1795, 612, 1592, 1056, 51, 1760, 1625, 1727, 1226, 389, 1166, 1049, 1701, 1582, 1113, 1626, 881, 469, 1464, 540, 82, 1052, 199, 564, 1325, 762, 833, 575, 1982, 1600, 432, 637, 370, 1668, 678, 562, 1592, 1258, 1666, 1318, 1607, 31, 1536, 311, 1971, 283, 504, 1563, 484, 1962, 40, 404, 1943, 1255, 700, 1929, 1482, 562, 37, 478, 142, 1284, 1495, 1356, 1736, 829, 800, 1010, 1037, 1704, 1862, 755, 230, 1335, 265, 514, 1847, 1211, 673, 1030, 511, 1760, 1065, 1019, 93, 818, 938, 1861, 183, 642, 1962, 908, 1413, 64, 438, 1700, 1796, 1071, 1653, 149, 561, 292, 629, 919, 1269, 244, 1715, 1691, 456, 406, 1284, 1343, 1883, 85, 890, 1043, 285, 256, 1906, 1702, 1621, 1566, 354, 1284, 1623, 117, 1725, 612, 150, 483, 1337, 1817, 536, 179, 362, 1397, 1741, 267, 15, 1319, 235, 926, 475, 326, 62, 1618, 1992, 451, 1909, 942, 530, 695, 905, 1485, 999, 1049, 86, 1844, 403, 472, 1783, 1082, 1971, 1309, 1988, 1146, 1591, 728, 747, 1525, 1366, 1182, 1848, 214, 1008, 1774, 1021, 1928, 941, 1205, 971, 1814, 1532, 386, 135, 1607, 955, 202, 929, 1396, 171, 237, 833, 1083, 392, 276, 144, 1381, 558, 734, 1658, 1737, 1042, 1087, 364, 142, 1430, 181, 1289, 1519, 742, 1342, 1461, 1331, 586, 184, 1995, 833, 250, 215, 654, 1791, 1765, 1700, 1439, 130, 1418, 1952, 887, 1170, 1853, 16, 1822, 1916, 580, 1140, 1201, 180, 928, 1415, 153, 1097, 1750, 659, 606, 1110, 1932, 1270, 835, 570, 470, 881, 16, 1587, 248, 179, 930, 1922, 761, 1400, 116, 1697, 1905, 974, 186, 362, 391, 736, 829, 1473, 1588, 906, 1201, 1704, 588, 1811, 1774, 200, 8, 1337, 1497, 53, 772, 776, 1722, 1835, 151, 1630, 1512, 1406, 683, 988, 1186, 1081, 435, 1563, 1348, 1480, 327, 1773, 1289, 1669, 787, 1929, 1262, 512, 415, 1277, 633, 52, 1603, 936, 221, 130, 1405, 915, 1317, 116, 17, 1687, 323, 1044, 1619, 76, 1240, 1486, 1352, 811, 745, 1251, 1454, 1972, 93, 121, 134, 1712, 1054, 1354, 335, 1369, 1965, 423, 1070, 812, 139, 855, 1424, 742, 492, 53, 686, 841, 819, 346, 1620, 1942, 34, 1956, 1060, 185, 1783, 867, 846, 375, 351, 554, 1131, 903, 1972, 781, 321, 1151, 672, 662, 746, 1904, 449, 788, 424, 794, 21, 1345, 661, 731, 1001, 1124, 745, 1722, 299, 1528, 930, 439, 923, 287, 1360, 1522, 458, 992, 263, 1483, 1621, 1124, 1675, 833, 1323, 1060, 1147, 42, 580, 953, 1117, 226, 534, 472, 663, 1109, 1780, 1886, 1191, 1653, 855, 1525, 1424, 106, 1686, 1095, 1775, 531, 273, 1853, 356);
    //81
    System.out.println(longestIncreasingSubIterative(list));
  }



  Map<String,Integer> map = new HashMap();
  private int longestIncreasingSub(List<Integer> A, int end,int lastNumIndex){
    if(end==A.size()){
      return 0;
    }
    String key = end+":"+lastNumIndex;
    if(map.get(key)!=null){
      return map.get(key);
    }
    int value1=0;

    int value2=0;
    if(lastNumIndex==-1 ||  A.get(end) > A.get(lastNumIndex)){
      value1 = 1 + longestIncreasingSub(A,end+1,end);
    }
    value2 = longestIncreasingSub(A,end+1,lastNumIndex);
    int value= Math.max(value1,value2);
    map.put(key,value);
    return value;
  }


  private static int longestIncreasingSubIterative(List<Integer> A){
    int n = A.size();
    int LIS[] = new int[n];
    for(int i=0;i<n;i++){
      LIS[i]=1;
    }
    for (int i = 1; i < n; i++)
      for (int j = 0; j < i; j++)
        if (A.get(i) > A.get(j) && LIS[i] < LIS[j] + 1)
          LIS[i] = LIS[j] + 1;

    /* Pick maximum of all LIS values */
    int max=0;
    for (int i = 0; i < n; i++)
      if (max < LIS[i])
        max = LIS[i];
    return max;
  }


}
